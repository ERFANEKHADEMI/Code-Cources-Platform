{% include 'index.html' %}
{% load static %}

{% block title %}
<title>{{user.username}}</title>
{% endblock title %}

{% block content %}
<div class="page profile">
    {% comment %}TODO: header {% endcomment %}
    <div class="profile__header">
        <div class="profile__header__right">
            {% if profile.image %}
            <img src="http://127.0.0.1:8000/static/media/{{profile.image}}" class="profile__header__right__icon" alt="profile icon">
            {% else %}
            <img src="{{ProfileImage}}" alt="ProfileImage" class="profile__header__right__icon">
            {% endif %}
            <div class="profile__header__right__info">
                <h2>{{user.username}}</h2>
                {% if request.user.username == user.username %}
                    <p>{{user.email}}</p>
                {% endif %}
            </div>
        </div>
        <div class="profile__header__left">
            <div class="expirense">Expirense: <span>100</span></div>
        </div>

    </div>
    <div class="profile__body">
        <div class="profile__body__left">
            {% comment %} TODO: Menu {% endcomment %}
            <a href="{% url 'base:profile' user.username %}" class="link">
                <span class="material-symbols-outlined">
                    person
                </span>    
                 Profile
            </a>
            <a href="{% url 'base:profile-likes' user.username %}" class="link">
                <span class="material-symbols-outlined">favorite</span>
                Likes
            </a>
            {% comment %} <a href="{% url 'base:profile' user.username %}" class="link">
                <span class="material-symbols-outlined">
                    bookmark
                </span>
                Bookmarks
            </a> {% endcomment %}
             {% comment %} <a href="{% url 'base:profile' user.username %}" class="link">
                <span class="material-symbols-outlined">
                    workspace_premium
                    </span>
                Sertificates
            </a>  {% endcomment %}
            {% if request.user.is_authenticated %}
                {% if request.user.is_superuser %}
                    <a href="{% url 'base:profile-courses' user.username %}" class="link">
                        <span class="material-symbols-outlined">
                            school  
                        </span>
                        Courses
                    </a>
                    <a href="{% url 'base:profile-articles' user.username %}" class="link">
                        <span class="material-symbols-outlined">
                            description
                            </span>
                        Articles
                    </a>
                {% endif %}
            {% endif %}
            <!-- <a href="" class="link">Certificates</a> -->
            {% if request.user.username == user.username %}
            <a href="{% url 'base:profile-update' user.username %}" class="link">
                <span class="material-symbols-outlined">
                    settings
                </span>
                Settings
            </a>
            {% endif %}
        </div>

        <div class="profile__body__right">
            {% comment %} TODO: PAGE {% endcomment %}
            {% if page == 'profile' %} 
            {% comment %} ? IF WE CLICK ON ABOUT BUTTON {% endcomment %}
            <p><b>About:</b> {{profile.bio}}</p>
            <p><b>Joined</b> {{profile.created}}</p>
            <div class="profile__body__right__icons">
                {% if profile.twitter %}
                    <a href="https://twitter.com/{{profile.twitter}}" target="_blank">
                        <img src="{% static 'images/twitter.png' %}" alt="twitter"/>
                    </a>
                {% endif %}
                {% if profile.github %}
                <a href="https://github.com/{{profile.github}}"  target="_blank">
                    <img src="{% static 'images/github.png' %}"  alt="twitter"/>
                </a>
                {% endif %}
                {% if profile.telegram %}
                <a href="https://t.me/{{profile.telegram}}" target="_blank">
                    <img src="{% static 'images/telegram.png' %}" alt="twitter"/>
                </a>
                {% endif %}
                {% if profile.website %}
                    <a href="{{profile.website}}" target="_blank">
                        <span class="material-symbols-outlined icon icon-profile">
                            language
                        </span>
                    </a>
                {% endif %}
            </div>
            {% endif %}
            {% if page == 'articles' %}
            {% comment %} ? IF WE CLICK ON ARTICLES {% endcomment %}
                {% if request.user.is_authenticated %}
                    {% if request.user.is_superuser %}
                        {% if user.is_superuser %}
                        <div class="page__panel">
                            <a href="{% url 'article:create_article' %}" class="btn btn-delete">
                                {% comment %} <span>Add New Post</span> {% endcomment %}
                                <span class="material-symbols-outlined ">
                                    drive_file_rename_outline
                                </span>
                            </a>
                        </div>
                        {% endif %}
                    {% endif %}
                 {% endif %}
                <div class="courses page__article__articles">
                    {% for article in articles %}
                        <article>
                            <div class="article__head ">
                                <div class="">{{article.title}}</div>
                                <a href="{% url 'article:show_article' article.slug %}" class="material-symbols-outlined icon link">
                                    arrow_forward
                                </a>
                            </div>
                            <div class="article__body">
                                {{article.text | truncatewords:30 }}
                            </div>
                            {% if request.user.is_authenticated %}
                                {% if request.user.is_superuser %}
                                    {% if request.user.username == article.user.username %}
                                        <div class="article__head article__buttons">
                                            <a href="{% url 'article:update_article' article.slug %}" class="btn btn-icon">
                                                <span class="material-symbols-outlined">
                                                    edit_square
                                                </span>
                                            </a>
                                            <a href="{% url 'article:delete_article' article.slug %}" class="btn btn-delete">
                                                <span class="material-symbols-outlined">
                                                delete_forever
                                                </span>
                                            </a>
                                        </div>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        </article>
                    {% endfor %}
                </div>
            {% endif %}

            {% if page == 'likes' %}
            {% comment %} TODO:  GET LIKES {% endcomment %}
            <div class="courses page__article__articles">
               {% if like_articles %}
               {% for article in like_articles %}
               <article>
                   <div class="article__head ">
                       <div class="">{{article.title}}</div>
                       <a href="{% url 'article:show_article' article.slug %}" class="material-symbols-outlined icon link">
                           arrow_forward
                       </a>
                   </div>
                   <div class="article__body">
                       {{article.text | truncatewords:30 }}
                   </div>
                   {% if request.user.is_authenticated %}
                       {% if request.user.is_superuser %}
                           {% if request.user.username == article.user.username %}
                               <div class="article__head article__buttons">
                                   <a href="{% url 'article:update_article' article.slug %}" class="btn btn-icon">
                                       <span class="material-symbols-outlined">
                                           edit_square
                                       </span>
                                   </a>
                                   <a href="{% url 'article:delete_article' article.slug %}" class="btn btn-delete">
                                       <span class="material-symbols-outlined">
                                       delete_forever
                                       </span>
                                   </a>
                               </div>
                           {% endif %}
                       {% endif %}
                       {% if status %}
                               <div class=" article__head article__buttons">
                                   <div href=""><b>#{{article.tag}}</b></div>
                                   <form action="" method="POST" class="like__form">
                                       {% if request.user.is_authenticated %}
                                           {% csrf_token %}
                                           <!-- <span>{{ likes }}</span> -->
                                           <span class="icon icon__love icon__span">{{article.likesForArticle.count}}</span>
                                           <a href="{% url 'article:show_article' article.slug %}#like" class="material-symbols-outlined icon icon__love" id = "like">
                                               favorite
                                           </a>
                                       {% endif %}
                                   </form>
                               </div>
                       {% endif %}
                   {% endif %}
               </article>
           {% endfor %}
           {% else %}
           <div class="not__found">
                <span class="material-symbols-outlined not-found-icon">
                    image_not_supported
                </span>
                <h2>Articles Not Found</h2>
            </div>
               {% endif %}

            </div>
            {% endif %}

            {% if page == 'courses' %}
                {% if request.user.is_superuser %}
                <div class="page__panel">
                    <a href="{% url 'courses:create-course' %}" class="btn btn-delete">
                        {% comment %} <span>Add New Post</span> {% endcomment %}
                        <span class="material-symbols-outlined ">
                            drive_file_rename_outline
                        </span>
                    </a>
                </div>
                {% endif %}
                <div class="courses">
                    {% for course in courses  %}
                        <div class="course">
                            <div class="course__image">
                                <img src="http://127.0.0.1:8000/static/media/{{course.image}}" alt="" class="course__img">
                                <div class="course__mask"></div>
                            </div>
                            <div class="course__info">
                                <div class="course__info__desc">
                                    <a href="{% url 'courses:course' course.slug %}" class = 'course__title '>{{course.title}}</a>
                                    <p>{{course.description|truncatewords:30}}</p>
                                </div>
                                {% if request.user.is_authenticated %}
                                    {% if request.user.is_superuser %}
                                        {% if request.user.username == course.user.username %}
                                            <div class="course__info__tables ">
                                                <a href="" class="btn btn-icon">
                                                    <span class="material-symbols-outlined">
                                                        edit_square
                                                    </span>
                                                </a>
                                                <a href="" class="btn btn-delete">
                                                    <span class="material-symbols-outlined">
                                                    delete_forever
                                                    </span>
                                                </a>
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                                <div class="course__info__tables">
                                    <a href="/">{{course.user}}</a>
                                    <a href="/">#{{course.tags}}</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}